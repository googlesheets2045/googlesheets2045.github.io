<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Science Master - Game Edukasi SMP</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #3498db, #2ecc71);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            padding: 20px;
        }
        
        /* PLAYER INFO - Dioptimalkan untuk 3 item */
        .player-info {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap; /* Memastikan responsif di layar kecil */
            gap: 10px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .level-count, .score, .category-info {
            font-size: 1.1rem;
            font-weight: bold;
            flex: 1 1 30%; /* Pembagian lebar yang merata */
            min-width: 150px;
        }

        @media (max-width: 768px) {
             .player-info {
                flex-direction: column;
                align-items: flex-start;
             }
             .level-count, .score, .category-info {
                 min-width: 100%;
             }
        }
        
        .level-count span, .score span, .category-info span {
            color: #e74c3c;
        }
        
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 20px;
            background: linear-gradient(to right, #3498db, #2ecc71);
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .menu-item {
            background: linear-gradient(to bottom right, #3498db, #2ecc71);
            color: white;
            padding: 25px 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .menu-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }
        
        .menu-item i {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
            /* PERBAIKAN: Menjaga aspek rasio ikon tetap bulat */
            line-height: 1; 
        }
        
        .menu-item h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }
        
        .menu-item p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .level-selection {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .level-btn {
            background: linear-gradient(to bottom, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 15px 5px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
        }
        
        .level-btn:hover:not(.locked) {
            transform: translateY(-3px);
            box-shadow: 0 5px 8px rgba(0, 0, 0, 0.3);
        }
        
        .level-btn.completed {
            background: linear-gradient(to bottom, #2ecc71, #27ae60);
        }
        
        .level-btn.current {
            background: linear-gradient(to bottom, #f39c12, #e67e22);
            animation: pulse 2s infinite;
        }
        
        .level-btn.locked {
            background: linear-gradient(to bottom, #95a5a6, #7f8c8d);
            cursor: not-allowed;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .quiz-container, .level-container {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .quiz-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .question-counter {
            font-weight: bold;
            color: #3498db;
        }
        
        .question {
            font-size: 1.3rem;
            margin-bottom: 20px;
            line-height: 1.5;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .option {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        
        .option:hover {
            background-color: #e8f4fc;
            border-color: #3498db;
        }
        
        .option.correct {
            background-color: #d4edda;
            border-color: #28a745;
            font-weight: bold;
        }
        
        .option.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            font-weight: bold;
        }
        
        /* HAPUS GAYA Penjelasan AI */
        /*
        #explanation-box { ... }
        #explanation-box h4 { ... }
        #explanation-loading { ... }
        */
        
        .navigation-center {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        button {
            background: linear-gradient(to right, #3498db, #2ecc71);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
        }
        
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .home-btn {
            background: linear-gradient(to right, #e74c3c, #f39c12);
        }
        
        .next-level-btn {
            background: linear-gradient(to right, #9b59b6, #8e44ad);
        }
        
        .retry-btn {
            background: linear-gradient(to right, #e67e22, #d35400);
        }
        
        .result {
            text-align: center;
            padding: 30px;
        }
        
        .result h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #2ecc71;
        }
        
        .result-score {
            font-size: 3rem;
            font-weight: bold;
            color: #e74c3c;
            margin: 20px 0;
        }
        
        .level-up {
            animation: levelUp 1s ease;
        }
        
        @keyframes levelUp {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .congratulations {
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            animation: celebrate 2s infinite;
        }
        
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background-color: #34495e;
            color: white;
            margin-top: 30px;
            border-radius: 0 0 15px 15px;
        }
        
        @media (max-width: 768px) {
            .menu {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .level-selection {
                grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            }
            
            .navigation-center {
                flex-direction: column;
                align-items: center;
            }
            
            .navigation-center button {
                width: 100%;
                max-width: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Science Master</h1>
            <p class="subtitle">Game Edukasi Science SMP dengan Total 4000 Soal</p>
        </header>
        
        <div class="game-area">
            <div class="player-info">
                <div class="level-count">Progress Selesai: <span id="total-completed-count">0 / 100</span></div>
                
                <div class="score">Skor Total: <span id="current-score">0</span></div>
                <div class="category-info">Progres Kategori: <span id="current-category">-</span></div>
            </div>
            
            <div class="progress-container" title="Progress Total (0/400 Level)">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div id="main-menu">
                <div class="menu">
                    <div class="menu-item" id="physics-btn">
                        <i>‚öõÔ∏è</i>
                        <h3>Fisika</h3>
                        <p>100 Level (1000 Soal)</p>
                    </div>
                    <div class="menu-item" id="chemistry-btn">
                        <i>üß™</i>
                        <h3>Kimia</h3>
                        <p>100 Level (1000 Soal)</p>
                    </div>
                    <div class="menu-item" id="biology-btn">
                        <i>üî¨</i>
                        <h3>Biologi</h3>
                        <p>100 Level (1000 Soal)</p>
                    </div>
                    <div class="menu-item" id="earth-btn">
                        <i>üåç</i>
                        <h3>Ilmu Bumi</h3>
                        <p>100 Level (1000 Soal)</p>
                    </div>
                </div>
            </div>
            
            <div id="level-selection-container" class="level-container" style="display: none;">
                <h2 id="level-selection-title">Pilih Level</h2>
                <div class="level-selection" id="level-selection">
                    </div>
                <div class="navigation-center">
                    <button class="home-btn" id="level-selection-home">Kembali ke Menu Utama</button>
                </div>
            </div>
            
            <div id="quiz-container" class="quiz-container">
                <div class="quiz-header">
                    <div class="category" id="quiz-category" style="font-weight: bold;"></div>
                    <div class="question-counter">Level: <span id="quiz-level">1</span> | Soal: <span id="current-question">1</span>/<span id="total-questions">10</span></div>
                </div>
                
                <div class="question" id="question-text">
                    Memuat pertanyaan...
                </div>
                
                <div class="options" id="options-container">
                    </div>

                <div class="navigation-center">
                    <button id="prev-btn" disabled>‚¨ÖÔ∏è Sebelumnya</button>
                    <button id="next-btn">Selanjutnya ‚û°Ô∏è</button>
                </div>
            </div>
            
            <div id="result-container" class="quiz-container result" style="display: none;">
                <h2 id="result-title">Selamat!</h2>
                <p id="result-subtitle">Kamu telah menyelesaikan level</p>
                <div class="result-score" id="final-score">85%</div>
                <p id="result-message">Pengetahuan science-mu cukup baik!</p>
                
                <div id="level-complete-message" class="congratulations" style="display: none;">
                    <h3>üéâ Level Berhasil Diselesaikan! üéâ</h3>
                    <p>Siap untuk tantangan berikutnya!</p>
                </div>
                
                <div class="navigation-center">
                    <button id="next-level-btn" class="next-level-btn" style="display: none;">Level Berikutnya</button>
                    <button id="retry-btn" class="retry-btn">Ulangi Level</button>
                    <button class="home-btn" id="result-home-btn">Kembali ke Menu Utama</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Science Master ¬© 2025 | dibuat oleh dev_nurdin</p>
        </footer>
    </div>

    <script>
        // ===============================
        // DATA PERTANYAAN (30 template unik per kategori)
        // ===============================

        const massiveQuestionBank = {
            physics: [
                { question: "Apa satuan SI untuk gaya?", options: ["Newton", "Joule", "Watt", "Pascal"], correct: 0 },
                { question: "Energi yang dimiliki benda karena geraknya disebut?", options: ["Energi potensial", "Energi kinetik", "Energi panas", "Energi listrik"], correct: 1 },
                { question: "Alat untuk mengukur suhu adalah?", options: ["Barometer", "Termometer", "Hygrometer", "Speedometer"], correct: 1 },
                { question: "Bunyi merambat paling cepat melalui?", options: ["Udara", "Cairan", "Padatan", "Vakum"], correct: 2 },
                { question: "Hukum Newton pertama tentang?", options: ["Gravitasi", "Inersia", "Aksi-reaksi", "Percepatan"], correct: 1 },
                { question: "Warna dengan panjang gelombang terpendek?", options: ["Merah", "Hijau", "Biru", "Ungu"], correct: 3 },
                { question: "Alat ukur tekanan udara?", options: ["Termometer", "Barometer", "Hygrometer", "Anemometer"], correct: 1 },
                { question: "Gaya tarik antara benda bermassa?", options: ["Magnet", "Listrik", "Gravitasi", "Gesek"], correct: 2 },
                { question: "Energi dalam baterai berupa?", options: ["Kinetik", "Kimia", "Panas", "Mekanik"], correct: 1 },
                { question: "Transformator meningkatkan tegangan jika?", options: ["Lilitan sekunder lebih banyak", "Lilitan primer lebih banyak", "Arus besar", "Tegangan kecil"], correct: 0 },
                { question: "Rumus energi kinetik?", options: ["¬Ωmv¬≤", "mgh", "F.d", "P.t"], correct: 0 },
                { question: "Hukum kekekalan energi menyatakan?", options: ["Energi dapat diciptakan", "Energi dapat dimusnahkan", "Energi tetap total", "Energi berubah bentuk"], correct: 2 },
                { question: "Dalam rangkaian paralel, lampu?", options: ["Padam semua jika satu padam", "Tetap menyala", "Menyala terang", "Berkedip"], correct: 1 },
                { question: "Percepatan benda 5kg dengan gaya 20N?", options: ["0.25 m/s¬≤", "4 m/s¬≤", "25 m/s¬≤", "100 m/s¬≤"], correct: 1 },
                { question: "Alat ukur arus listrik?", options: ["Voltmeter", "Amperemeter", "Ohmmeter", "Wattmeter"], correct: 1 },
                { question: "Satuan daya listrik?", options: ["Volt", "Ampere", "Watt", "Ohm"], correct: 2 },
                { question: "Perubahan energi di panel surya?", options: ["Kimia ke Listrik", "Cahaya ke Listrik", "Panas ke Cahaya", "Gerak ke Listrik"], correct: 1 },
                { question: "Alat pengubah energi listrik jadi gerak?", options: ["Generator", "Transformator", "Motor listrik", "Baterai"], correct: 2 },
                { question: "Kecepatan cahaya di vakum?", options: ["300.000 km/s", "30.000 km/s", "3.000 km/s", "300 km/s"], correct: 0 },
                { question: "Titik didih air pada tekanan normal?", options: ["0¬∞C", "50¬∞C", "100¬∞C", "150¬∞C"], correct: 2 },
                { question: "Konduktor panas yang baik?", options: ["Plastik", "Kayu", "Udara", "Logam"], correct: 3 },
                { question: "Hukum yang mengatur hubungan tekanan dan volume gas?", options: ["Hukum Archimedes", "Hukum Pascal", "Hukum Boyle", "Hukum Snellius"], correct: 2 },
                { question: "Contoh gelombang transversal?", options: ["Bunyi", "Gempa", "Cahaya", "Air di kolam"], correct: 2 },
                { question: "Energi yang tersimpan dalam pegas tertekan?", options: ["Kinetik", "Potensial Gravitasi", "Potensial Elastis", "Panas"], correct: 2 },
                { question: "Alat yang digunakan untuk mengukur massa benda?", options: ["Amperemeter", "Termometer", "Neraca", "Barometer"], correct: 2 },
                { question: "Gaya yang melawan gerak benda?", options: ["Gaya tarik", "Gaya magnet", "Gaya gesek", "Gaya sentripetal"], correct: 2 },
                { question: "Satuan frekuensi?", options: ["Joule", "Watt", "Ohm", "Hertz"], correct: 3 },
                { question: "Apa yang menyebabkan pelangi?", options: ["Refleksi cahaya", "Difraksi cahaya", "Pembiasan dan pemantulan cahaya", "Interferensi"], correct: 2 },
                { question: "Zat yang tidak dapat menghantarkan listrik?", options: ["Konduktor", "Semikonduktor", "Isolator", "Elektrolit"], correct: 2 },
                { question: "Jarak dari puncak gelombang ke puncak berikutnya?", options: ["Amplitudo", "Periode", "Frekuensi", "Panjang gelombang"], correct: 3 }
            ],
            
            chemistry: [
                { question: "Unsur paling melimpah di atmosfer?", options: ["Oksigen", "Hidrogen", "Nitrogen", "Karbon dioksida"], correct: 2 },
                { question: "Perubahan wujud dari padat langsung ke gas disebut?", options: ["Mencair", "Membeku", "Menyublim", "Mengembun"], correct: 2 },
                { question: "Berapa nilai pH larutan yang bersifat netral?", options: ["0", "7", "14", "10"], correct: 1 },
                { question: "Reaksi kimia yang menyerap panas dari lingkungan disebut?", options: ["Eksotermik", "Endotermik", "Netral", "Otomatis"], correct: 1 },
                { question: "Lambang kimia untuk unsur emas adalah?", options: ["Ag", "Fe", "Au", "Cu"], correct: 2 },
                { question: "Unsur dengan nomor atom 1 adalah?", options: ["Helium", "Oksigen", "Hidrogen", "Litium"], correct: 2 },
                { question: "Larutan dengan pH kurang dari 7 bersifat?", options: ["Basa", "Netral", "Asam", "Garam"], correct: 2 },
                { question: "Proses perkaratan besi pada dasarnya adalah reaksi?", options: ["Oksidasi", "Reduksi", "Netralisasi", "Presipitasi"], correct: 0 },
                { question: "Gas yang dihasilkan dari reaksi logam alkali dengan air atau asam?", options: ["Oksigen", "Nitrogen", "Hidrogen", "Karbon dioksida"], correct: 2 },
                { question: "Zat yang mempercepat laju reaksi tanpa ikut bereaksi disebut?", options: ["Inhibitor", "Katalis", "Reaktan", "Produk"], correct: 1 },
                { question: "Kelompok unsur alkali?", options: ["Na, K, Li", "Fe, Cu, Zn", "Cl, F, Br", "He, Ne, Ar"], correct: 0 },
                { question: "Hasil reaksi antara asam dan basa?", options: ["Gas", "Garam dan air", "Logam", "Oksigen"], correct: 1 },
                { question: "Lambang kimia natrium?", options: ["Na", "Ni", "Ne", "No"], correct: 0 },
                { question: "Pemisahan campuran berdasarkan perbedaan titik didih?", options: ["Filtrasi", "Destilasi", "Kromatografi", "Sublimasi"], correct: 1 },
                { question: "Contoh gas mulia?", options: ["Oksigen", "Nitrogen", "Helium", "Klorin"], correct: 2 },
                { question: "Bagian terkecil dari suatu unsur yang masih memiliki sifat unsur tersebut?", options: ["Molekul", "Senyawa", "Atom", "Isotop"], correct: 2 },
                { question: "Perubahan materi yang menghasilkan zat baru dengan sifat yang berbeda?", options: ["Perubahan fisika", "Perubahan kimia", "Perubahan wujud", "Perubahan alotropi"], correct: 1 },
                { question: "Contoh senyawa organik sederhana?", options: ["Gula", "Garam", "Air", "Besi"], correct: 0 },
                { question: "Partikel sub-atomik yang bermuatan negatif dalam atom?", options: ["Proton", "Neutron", "Elektron", "Inti atom"], correct: 2 },
                { question: "Campuran homogen yang zat terlarut dan pelarutnya terlihat menyatu sempurna?", options: ["Suspensi", "Koloid", "Emulsi", "Larutan"], correct: 3 },
                { question: "Rumus kimia untuk air?", options: ["HO‚ÇÇ", "H‚ÇÇO‚ÇÇ", "H‚ÇÇO", "OH"], correct: 2 },
                { question: "Zat yang berfungsi sebagai pelarut universal?", options: ["Minyak", "Alkohol", "Air", "Asam"], correct: 2 },
                { question: "Tanda-tanda utama yang menunjukkan terjadinya reaksi kimia?", options: ["Perubahan bentuk", "Perubahan volume", "Perubahan warna/suhu", "Perubahan massa"], correct: 2 },
                { question: "Proses pemisahan komponen minyak mentah berdasarkan titik didih yang berbeda?", options: ["Sublimasi", "Kristalisasi", "Destilasi bertingkat", "Filtrasi"], correct: 2 },
                { question: "Nama lain dari proses penguapan?", options: ["Kondensasi", "Evaporasi", "Sublimasi", "Mencair"], correct: 1 },
                { question: "Zat yang dapat menerima proton (H+) dalam teori asam-basa Bronsted-Lowry?", options: ["Asam kuat", "Basa", "Larutan netral", "Indikator"], correct: 1 },
                { question: "Nomor atom suatu unsur menunjukkan jumlah?", options: ["Neutron", "Elektron valensi", "Proton", "Massa atom"], correct: 2 },
                { question: "Contoh senyawa yang terbentuk dari ikatan ion?", options: ["Garam dapur (NaCl)", "Air (H‚ÇÇO)", "Metana (CH‚ÇÑ)", "Oksigen (O‚ÇÇ)"], correct: 0 },
                { question: "Peristiwa perubahan es menjadi air adalah contoh dari?", options: ["Perubahan kimia", "Perubahan nuklir", "Perubahan fisika", "Reaksi redoks"], correct: 2 },
                { question: "Kelompok unsur yang sangat stabil dan tidak reaktif?", options: ["Alkali", "Halogen", "Gas mulia", "Transisi"], correct: 2 }
            ],
            
            biology: [
                { question: "Organel sel yang berfungsi sebagai 'pembangkit tenaga' sel?", options: ["Nukleus", "Mitokondria", "Ribosom", "Kloroplas"], correct: 1 },
                { question: "Proses pembuatan makanan pada tumbuhan hijau disebut?", options: ["Respirasi", "Fotosintesis", "Digesti", "Fermentasi"], correct: 1 },
                { question: "Sistem peredaran darah manusia terdiri dari?", options: ["Jantung, paru, pembuluh", "Jantung, darah, pembuluh", "Darah, pembuluh, otak", "Jantung, otak, paru"], correct: 1 },
                { question: "Bagian utama tumbuhan yang berfungsi menyerap air dan nutrisi?", options: ["Batang", "Daun", "Akar", "Bunga"], correct: 2 },
                { question: "Makhluk hidup yang dapat membuat makanannya sendiri disebut?", options: ["Konsumen", "Produsen", "Dekomposer", "Herbivora"], correct: 1 },
                { question: "Pertukaran gas oksigen dan karbon dioksida terjadi di?", options: ["Jantung", "Paru-paru", "Hati", "Ginjal"], correct: 1 },
                { question: "Bagian sel yang mengendalikan seluruh aktivitas sel?", options: ["Mitokondria", "Nukleus", "Sitoplasma", "Membran sel"], correct: 1 },
                { question: "Hewan yang memakan tumbuhan dan daging disebut?", options: ["Herbivora", "Karnivora", "Omnivora", "Insektivora"], correct: 2 },
                { question: "Perubahan bentuk pada hewan dari ulat menjadi kupu-kupu disebut?", options: ["Fotosintesis", "Metamorfosis", "Respirasi", "Evolusi"], correct: 1 },
                { question: "Organ yang berfungsi menyaring darah dan membuang limbah nitrogen?", options: ["Jantung", "Paru-paru", "Ginjal", "Hati"], correct: 2 },
                { question: "Jaringan pengangkut air pada tumbuhan?", options: ["Epidermis", "Xilem", "Floem", "Kolenkim"], correct: 1 },
                { question: "Enzim yang berfungsi mencerna protein?", options: ["Amilase", "Lipase", "Protease", "Sukrase"], correct: 2 },
                { question: "Bagian bunga yang menghasilkan serbuk sari?", options: ["Putik", "Benang sari", "Mahkota", "Kelopak"], correct: 1 },
                { question: "Penyakit yang disebabkan kekurangan vitamin C?", options: ["Rabun senja", "Skorbut", "Rakitis", "Anemia"], correct: 1 },
                { question: "Contoh dekomposer dalam ekosistem?", options: ["Tumbuhan", "Hewan", "Jamur dan bakteri", "Manusia"], correct: 2 },
                { question: "Tempat utama fotosintesis terjadi dalam sel tumbuhan?", options: ["Vakuola", "Ribosom", "Kloroplas", "Membran sel"], correct: 2 },
                { question: "Penyakit yang disebabkan oleh Human Immunodeficiency Virus (HIV)?", options: ["TBC", "Flu", "AIDS", "Malaria"], correct: 2 },
                { question: "Proses pembentukan urin di ginjal yang pertama kali terjadi?", options: ["Augmentasi", "Reabsorpsi", "Filtrasi", "Sekresi"], correct: 2 },
                { question: "Di mana materi genetik (DNA) sel disimpan?", options: ["Mitokondria", "Sitoplasma", "Nukleus", "Retikulum Endoplasma"], correct: 2 },
                { question: "Tulang yang berfungsi melindungi organ otak?", options: ["Tulang belakang", "Tulang rusuk", "Tengkorak", "Tulang panggul"], correct: 2 },
                { question: "Organ pencernaan yang menjadi tempat penyerapan sari makanan terbesar?", options: ["Lambung", "Usus besar", "Usus halus", "Kerongkongan"], correct: 2 },
                { question: "Kelompok hewan yang memiliki tulang belakang?", options: ["Invertebrata", "Avertebrata", "Vertebrata", "Mamalia"], correct: 2 },
                { question: "Hormon yang berperan dalam mengatur kadar gula darah?", options: ["Adrenalin", "Tiroksin", "Insulin", "Estrogen"], correct: 2 },
                { question: "Sistem organ yang berfungsi membuang sisa metabolisme dari tubuh?", options: ["Sistem sirkulasi", "Sistem pernapasan", "Sistem ekskresi", "Sistem reproduksi"], correct: 2 },
                { question: "Proses pertukaran oksigen dan karbon dioksida di alveoli paru-paru?", options: ["Osmosis", "Ekskresi", "Difusi", "Konveksi"], correct: 2 },
                { question: "Unit struktural dan fungsional terkecil dari makhluk hidup?", options: ["Organ", "Jaringan", "Sel", "Sistem organ"], correct: 2 },
                { question: "Lapisan pelindung terluar pada batang dan daun tumbuhan?", options: ["Korteks", "Endodermis", "Epidermis", "Floem"], correct: 2 },
                { question: "Nama ilmiah (binomial nomenclature) untuk spesies manusia?", options: ["Homo erectus", "Pan troglodytes", "Homo sapiens", "Australopithecus"], correct: 2 },
                { question: "Apa fungsi utama stomata (mulut daun)?", options: ["Menyerap air", "Melakukan fotosintesis", "Pertukaran gas", "Menyimpan makanan"], correct: 2 },
                { question: "Rantai makanan dalam ekosistem selalu dimulai dari?", options: ["Konsumen tingkat 1", "Produsen", "Dekomposer", "Karnivora"], correct: 1 }
            ],

            earth: [
                { question: "Lapisan bumi yang paling luar dan tempat kita hidup?", options: ["Inti", "Mantel", "Kerak", "Atmosfer"], correct: 2 },
                { question: "Planet di tata surya yang terdekat dengan Matahari?", options: ["Venus", "Bumi", "Mars", "Merkurius"], correct: 3 },
                { question: "Peristiwa di mana Bulan berada di antara Bumi dan Matahari?", options: ["Gerhana bulan", "Gerhana matahari", "Fase bulan", "Pasang surut"], correct: 1 },
                { question: "Gas utama yang paling berkontribusi terhadap efek rumah kaca?", options: ["Oksigen", "Nitrogen", "Karbon dioksida", "Helium"], correct: 2 },
                { question: "Perubahan wujud air dari cair menjadi uap air disebut?", options: ["Kondensasi", "Presipitasi", "Evaporasi", "Infiltrasi"], correct: 2 },
                { question: "Lapisan di atmosfer yang melindungi bumi dari sinar ultraviolet?", options: ["Troposfer", "Stratosfer", "Mesosfer", "Ozon"], correct: 3 },
                { question: "Planet terbesar dalam tata surya?", options: ["Bumi", "Mars", "Jupiter", "Saturnus"], correct: 2 },
                { question: "Jenis batuan yang terbentuk dari pendinginan magma?", options: ["Sedimen", "Metamorf", "Beku", "Kapur"], correct: 2 },
                { question: "Apa penyebab utama terjadinya pasang surut air laut?", options: ["Angin", "Rotasi bumi", "Gravitasi bulan", "Suhu air"], correct: 2 },
                { question: "Waktu Indonesia Barat (WIB) memiliki selisih berapa jam dari GMT (Greenwich Mean Time)?", options: ["5 jam", "6 jam", "7 jam", "8 jam"], correct: 2 },
                { question: "Bencana alam yang disebabkan oleh gempa bumi di dasar laut?", options: ["Angin topan", "Tsunami", "Gunung meletus", "Kebakaran hutan"], correct: 1 },
                { question: "Proses penghancuran batuan oleh faktor air, angin, dan es?", options: ["Erosi", "Sedimentasi", "Pelapukan mekanik", "Pelapukan kimia"], correct: 2 },
                { question: "Planet yang sering dijuluki 'Bintang Kejora'?", options: ["Merkurius", "Venus", "Mars", "Jupiter"], correct: 1 },
                { question: "Lapisan bumi yang sebagian besar berupa batuan cair (magma)?", options: ["Kerak", "Mantel", "Inti luar", "Inti dalam"], correct: 2 },
                { question: "Proses di mana uap air di atmosfer berubah menjadi awan/titik-titik air?", options: ["Evaporasi", "Kondensasi", "Presipitasi", "Infiltasi"], correct: 1 },
                { question: "Satelit alami satu-satunya yang dimiliki oleh Bumi?", options: ["Mars", "Bintang", "Bulan", "Komet"], correct: 2 },
                { question: "Apa yang terutama disebabkan oleh pergerakan lempeng tektonik?", options: ["Angin kencang", "Banjir", "Gempa bumi", "Tsunami"], correct: 2 },
                { question: "Jenis batuan yang terbentuk dari batuan beku atau sedimen akibat perubahan suhu dan tekanan tinggi?", options: ["Batuan sedimen", "Batuan metamorf", "Batuan beku", "Mineral"], correct: 1 },
                { question: "Nama galaksi tempat tata surya kita berada?", options: ["Andromeda", "Triangulum", "Bimasakti", "Sombrero"], correct: 2 },
                { question: "Alat yang digunakan oleh ahli meteorologi untuk mengukur kecepatan angin?", options: ["Termometer", "Barometer", "Anemometer", "Hygrometer"], correct: 2 },
                { question: "Zona waktu yang digunakan di Indonesia bagian timur?", options: ["WIB", "WITA", "WIT", "GMT+8"], correct: 2 },
                { question: "Fenomena naiknya permukaan air laut secara signifikan saat bulan purnama?", options: ["Pasang surut minimum", "Badai laut", "Pasang maksimum", "Kondensasi"], correct: 2 },
                { question: "Proses perubahan wujud air dari uap menjadi cair yang membentuk awan?", options: ["Evaporasi", "Transpirasi", "Kondensasi", "Infiltrasi"], correct: 2 },
                { question: "Batuan yang terbentuk dari pengendapan material yang tererosi?", options: ["Batuan metamorf", "Batuan beku", "Batuan sedimen", "Batuan dasar"], correct: 2 },
                { question: "Gas yang paling melimpah di atmosfer Bumi?", options: ["Oksigen", "Karbon dioksida", "Nitrogen", "Argon"], correct: 2 },
                { question: "Musim di Bumi disebabkan oleh?", options: ["Jarak Bumi dari Matahari", "Rotasi Bumi", "Kemiringan sumbu Bumi", "Aktivitas Bulan"], correct: 2 },
                { question: "Matahari diklasifikasikan sebagai bintang jenis apa?", options: ["Raksasa Merah", "Katai Putih", "Deret utama", "Bintang Neutron"], correct: 2 },
                { question: "Daerah di mana satu lempeng tektonik menyelip di bawah lempeng lain, sering menyebabkan palung laut?", options: ["Sesar geser", "Peregangan", "Subduksi", "Pemekaran"], correct: 2 },
                { question: "Nama lain untuk wilayah yang sering mengalami gempa bumi dan gunung berapi di sekitar Samudra Pasifik?", options: ["Sabuk Alpide", "Cincin Api Pasifik", "Zona Subduksi", "Garis Wallace"], correct: 1 },
                { question: "Lapisan atmosfer Bumi tempat sebagian besar fenomena cuaca terjadi?", options: ["Stratosfer", "Mesosfer", "Termosfer", "Troposfer"], correct: 3 }
            ]
        };

        // Fungsi utilitas untuk mengacak array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Fungsi untuk menghasilkan pertanyaan unik untuk semua level (memastikan 4000 soal terstruktur)
        function generateQuestionsForCategory(category, totalLevels = 100, questionsPerLevel = 10) {
            const questions = {};
            const templates = massiveQuestionBank[category];
            
            for (let level = 1; level <= totalLevels; level++) {
                questions[level] = [];
                
                for (let i = 0; i < questionsPerLevel; i++) {
                    const templateIndex = (level * questionsPerLevel + i) % templates.length;
                    const template = templates[templateIndex];
                    
                    const newOptions = shuffleArray([...template.options]);
                    const originalCorrectAnswer = template.options[template.correct];
                    const newCorrectIndex = newOptions.findIndex(opt => opt === originalCorrectAnswer);

                    questions[level].push({
                        question: template.question,
                        options: newOptions,
                        correct: newCorrectIndex
                    });
                }
            }
            
            return questions;
        }

        // Data kuis lengkap untuk semua level
        const quizData = {
            physics: generateQuestionsForCategory('physics'),
            chemistry: generateQuestionsForCategory('chemistry'),
            biology: generateQuestionsForCategory('biology'),
            earth: generateQuestionsForCategory('earth')
        };

        // ===============================
        // SISTEM GAME UTAMA
        // ===============================

        // Status game
        const gameState = {
            currentCategory: '',
            currentLevel: 1,
            score: 0,
            totalScore: 0,
            completedLevels: {
                physics: [],
                chemistry: [],
                biology: [],
                earth: []
            },
            currentQuestions: [],
            currentQuestionIndex: 0,
            userAnswers: []
        };

        // Elemen DOM
        const mainMenu = document.getElementById('main-menu');
        const levelSelectionContainer = document.getElementById('level-selection-container');
        const levelSelection = document.getElementById('level-selection');
        const levelSelectionTitle = document.getElementById('level-selection-title');
        const quizContainer = document.getElementById('quiz-container');
        const resultContainer = document.getElementById('result-container');
        
        const physicsBtn = document.getElementById('physics-btn');
        const chemistryBtn = document.getElementById('chemistry-btn');
        const biologyBtn = document.getElementById('biology-btn');
        const earthBtn = document.getElementById('earth-btn');
        
        const totalCompletedCountElement = document.getElementById('total-completed-count'); 
        const currentScoreElement = document.getElementById('current-score');
        const currentCategoryElement = document.getElementById('current-category');
        const progressBar = document.getElementById('progress-bar');
        
        const quizCategoryElement = document.getElementById('quiz-category');
        const quizLevelElement = document.getElementById('quiz-level');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const currentQuestionElement = document.getElementById('current-question');
        const totalQuestionsElement = document.getElementById('total-questions');
        
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        
        const resultTitle = document.getElementById('result-title');
        const resultSubtitle = document.getElementById('result-subtitle');
        const finalScoreElement = document.getElementById('final-score');
        const resultMessageElement = document.getElementById('result-message');
        const levelCompleteMessage = document.getElementById('level-complete-message');
        
        const retryBtn = document.getElementById('retry-btn');
        const nextLevelBtn = document.getElementById('next-level-btn');
        const resultHomeBtn = document.getElementById('result-home-btn');
        const levelSelectionHome = document.getElementById('level-selection-home');

        /* BARIS DIHAPUS: AI Explanation Elements
        const explanationBox = document.getElementById('explanation-box');
        const explanationLoading = document.getElementById('explanation-loading');
        const explanationText = document.getElementById('explanation-text');
        */

        // Event listeners
        physicsBtn.addEventListener('click', () => showLevelSelection('physics'));
        chemistryBtn.addEventListener('click', () => showLevelSelection('chemistry'));
        biologyBtn.addEventListener('click', () => showLevelSelection('biology'));
        earthBtn.addEventListener('click', () => showLevelSelection('earth'));
        
        prevBtn.addEventListener('click', showPreviousQuestion);
        nextBtn.addEventListener('click', showNextQuestion);
        
        retryBtn.addEventListener('click', retryLevel);
        nextLevelBtn.addEventListener('click', nextLevel);
        resultHomeBtn.addEventListener('click', showMainMenu);
        levelSelectionHome.addEventListener('click', showMainMenu);

        /* DIHAPUS: FUNGSI AI GENERATION
        async function generateExplanation(questionText, correctAnswer) {
            // ... (Seluruh fungsi generateExplanation dihapus)
        }
        */

        // ===============================
        // FUNGSI GAMEFLOW
        // ===============================

        function showLevelSelection(category) {
            gameState.currentCategory = category;
            
            mainMenu.style.display = 'none';
            levelSelectionContainer.style.display = 'block';
            quizContainer.style.display = 'none';
            resultContainer.style.display = 'none';
            
            const categoryNames = { physics: 'Fisika', chemistry: 'Kimia', biology: 'Biologi', earth: 'Ilmu Bumi' };
            levelSelectionTitle.textContent = `Pilih Level - ${categoryNames[category]}`;
            
            levelSelection.innerHTML = '';
            const maxLevels = 100;
            for (let i = 1; i <= maxLevels; i++) {
                const levelBtn = document.createElement('button');
                levelBtn.classList.add('level-btn');
                levelBtn.textContent = i;
                
                if (gameState.completedLevels[category].includes(i)) {
                    levelBtn.classList.add('completed');
                }
                
                const nextLevelToUnlock = getNextLevelToUnlock(category);
                
                if (i > nextLevelToUnlock) {
                    levelBtn.classList.add('locked');
                    levelBtn.title = "Selesaikan level sebelumnya terlebih dahulu";
                } else {
                    if (i === nextLevelToUnlock) {
                        levelBtn.classList.add('current');
                    }
                    levelBtn.addEventListener('click', () => startLevel(category, i));
                }
                
                levelSelection.appendChild(levelBtn);
            }
            updatePlayerInfo();
        }

        function getNextLevelToUnlock(category) {
            const completed = gameState.completedLevels[category];
            if (completed.length === 0) return 1;
            
            const maxCompleted = Math.max(...completed);
            
            if (maxCompleted >= 100) return 100;
            
            return maxCompleted + 1;
        }

        function startLevel(category, level) {
            gameState.currentCategory = category;
            gameState.currentLevel = level;
            gameState.currentQuestionIndex = 0;
            
            gameState.currentQuestions = quizData[category][level];
            gameState.userAnswers = new Array(gameState.currentQuestions.length).fill(undefined);
            
            levelSelectionContainer.style.display = 'none';
            quizContainer.style.display = 'block';
            resultContainer.style.display = 'none';
            
            const categoryNames = { physics: 'Fisika', chemistry: 'Kimia', biology: 'Biologi', earth: 'Ilmu Bumi' };
            quizCategoryElement.textContent = categoryNames[category];
            quizLevelElement.textContent = level;
            
            // Sembunyikan penjelasan saat memulai soal baru (walaupun elemennya dihapus, kita memastikan tidak ada logika yang tertinggal)
            // explanationBox.style.display = 'none';
            
            updatePlayerInfo(); // Update info kategori saat level dimulai
            showQuestion();
        }

        function showQuestion() {
            const question = gameState.currentQuestions[gameState.currentQuestionIndex];
            
            currentQuestionElement.textContent = gameState.currentQuestionIndex + 1;
            totalQuestionsElement.textContent = gameState.currentQuestions.length;
            
            questionText.textContent = question.question;
            
            optionsContainer.innerHTML = '';
            
            const selectedAnswerIndex = gameState.userAnswers[gameState.currentQuestionIndex];
            const isAnswered = selectedAnswerIndex !== undefined;
            const correctIndex = question.correct;

            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('option');
                optionElement.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                optionElement.dataset.index = index;
                
                if (isAnswered) {
                    if (index === correctIndex) {
                        optionElement.classList.add('correct');
                    } else if (index === selectedAnswerIndex) {
                        optionElement.classList.add('incorrect');
                    }
                    optionElement.style.pointerEvents = 'none';
                } else {
                    optionElement.addEventListener('click', selectOption);
                }
                
                if (!isAnswered && index === selectedAnswerIndex) {
                    optionElement.classList.add('selected');
                }

                optionsContainer.appendChild(optionElement);
            });
            
            prevBtn.disabled = gameState.currentQuestionIndex === 0;
            
            if (gameState.currentQuestionIndex === gameState.currentQuestions.length - 1) {
                nextBtn.textContent = 'Selesai & Lihat Hasil üèÜ';
            } else {
                nextBtn.textContent = 'Selanjutnya ‚û°Ô∏è';
            }

            // HAPUS LOGIKA PENJELASAN AI DARI showQuestion
            // if (isAnswered) { explanationBox.style.display = 'block'; ... } else { explanationBox.style.display = 'none'; }
        }

        function selectOption(event) {
            const selectedOption = event.currentTarget;
            const selectedIndex = parseInt(selectedOption.dataset.index);
            
            gameState.userAnswers[gameState.currentQuestionIndex] = selectedIndex;
            
            const options = optionsContainer.children;
            const question = gameState.currentQuestions[gameState.currentQuestionIndex];
            const correctIndex = question.correct;

            // Tampilkan feedback visual
            for (let i = 0; i < options.length; i++) {
                options[i].classList.remove('selected');
                options[i].style.pointerEvents = 'none';
                
                if (i === correctIndex) {
                    options[i].classList.add('correct');
                } else if (i === selectedIndex) {
                    options[i].classList.add('incorrect');
                }
            }
            
            // HAPUS PANGGILAN GENERATE EXPLANATION DARI AI
            /*
            explanationBox.style.display = 'block';
            explanationLoading.style.display = 'block';
            explanationText.textContent = '';
            await generateExplanation(question.question, correctAnswerText);
            gameState.currentQuestions[gameState.currentQuestionIndex].explanation = explanationText.textContent;
            */
        }

        function showPreviousQuestion() {
            if (gameState.currentQuestionIndex > 0) {
                gameState.currentQuestionIndex--;
                showQuestion();
            }
        }

        function showNextQuestion() {
            if (gameState.userAnswers[gameState.currentQuestionIndex] === undefined) {
                alert('‚ö†Ô∏è Silakan pilih jawaban terlebih dahulu!');
                return;
            }

            if (gameState.currentQuestionIndex === gameState.currentQuestions.length - 1) {
                showResult();
                return;
            }
            
            gameState.currentQuestionIndex++;
            showQuestion();
        }

        function showResult() {
            quizContainer.style.display = 'none';
            resultContainer.style.display = 'block';
            
            let correctAnswers = 0;
            for (let i = 0; i < gameState.currentQuestions.length; i++) {
                if (gameState.userAnswers[i] === gameState.currentQuestions[i].correct) {
                    correctAnswers++;
                }
            }
            
            const percentage = Math.round((correctAnswers / gameState.currentQuestions.length) * 100);
            
            finalScoreElement.textContent = `${percentage}%`;
            
            let message = '';
            if (percentage >= 80) {
                message = 'Luar biasa! Kamu berhasil menguasai materi level ini.';
                resultTitle.textContent = 'Selamat!';
            } else if (percentage >= 60) {
                message = 'Bagus! Lanjutkan, kamu hampir menguasai materi ini.';
                resultTitle.textContent = 'Hampir Sempurna!';
            } else {
                message = 'Jangan menyerah! Anggap skor ini sebagai catatan untuk ditingkatkan di level berikutnya.';
                resultTitle.textContent = 'Lanjutkan!';
            }
            
            const levelCompletedSuccessfully = !gameState.completedLevels[gameState.currentCategory].includes(gameState.currentLevel);

            if (levelCompletedSuccessfully) {
                gameState.completedLevels[gameState.currentCategory].push(gameState.currentLevel);
                gameState.totalScore += percentage;
                updateProgress();
                updatePlayerInfo();
                saveProgress();
            }
            
            resultSubtitle.textContent = `Kamu telah menyelesaikan Level ${gameState.currentLevel} Kategori ${getCurrentCategoryName()}`;
            resultMessageElement.textContent = message;
            
            const isLastLevel = gameState.currentLevel === 100;
            
            if (!isLastLevel) {
                nextLevelBtn.style.display = 'inline-block';
                retryBtn.style.display = 'none';
                nextLevelBtn.textContent = `Level ${gameState.currentLevel + 1} ‚û°Ô∏è`;
                levelCompleteMessage.style.display = 'block';

                levelCompleteMessage.innerHTML = levelCompletedSuccessfully ? 
                    `<h3>‚úÖ Level ${gameState.currentLevel} Selesai! ‚úÖ</h3>
                    <p>Skor kamu ${percentage}%. Lanjut ke Level ${gameState.currentLevel + 1}!</p>`
                    : 
                    `<h3>Level ${gameState.currentLevel} Selesai Dikerjakan.</h3>
                    <p>Skor kamu ${percentage}%. Lanjut ke Level ${gameState.currentLevel + 1}!</p>`;

            } else {
                nextLevelBtn.style.display = 'none';
                retryBtn.style.display = 'inline-block';
                retryBtn.textContent = 'Ulangi Level 100';
                
                levelCompleteMessage.style.display = 'block';
                levelCompleteMessage.innerHTML = `
                    <h3>üéâ SELAMAT! Kamu MASTER SCIENCE! üéâ</h3>
                    <p>Kamu telah menyelesaikan semua 100 level ${getCurrentCategoryName()}!</p>
                `;
            }
        }

        function nextLevel() {
            const nextLvl = gameState.currentLevel + 1;
            
            if (nextLvl <= 100) {
                startLevel(gameState.currentCategory, nextLvl);
            } else {
                alert("Selamat! Kamu sudah menyelesaikan semua level di kategori ini!");
                showMainMenu();
            }
        }

        function retryLevel() {
            startLevel(gameState.currentCategory, gameState.currentLevel);
        }

        function showMainMenu() {
            mainMenu.style.display = 'block';
            levelSelectionContainer.style.display = 'none';
            quizContainer.style.display = 'none';
            resultContainer.style.display = 'none';
            
            updatePlayerInfo();
        }

        // FUNGSI PERBAIKAN: Update Player Info
        function updatePlayerInfo() {
            const totalCompleted = 
                gameState.completedLevels.physics.length +
                gameState.completedLevels.chemistry.length +
                gameState.completedLevels.biology.length +
                gameState.completedLevels.earth.length;
            
            const totalLevels = 400;

            const overallProgress = Math.min(100, Math.round((totalCompleted / totalLevels) * 100));

            // Progress Selesai (0-100)
            totalCompletedCountElement.textContent = `${overallProgress} / 100`;

            // Progres Kategori (Real-time)
            const currentCategoryName = getCurrentCategoryName();
            const currentLevel = gameState.currentLevel;
            
            let levelIndicator;
            if (quizContainer.style.display === 'block') {
                levelIndicator = `Lvl ${currentLevel}`;
            } else if (gameState.currentCategory) {
                levelIndicator = `Lvl ${getNextLevelToUnlock(gameState.currentCategory)}`;
            } else {
                levelIndicator = 'Lvl -';
            }


            currentCategoryElement.textContent = `${currentCategoryName} | ${levelIndicator}`;

            currentScoreElement.textContent = gameState.totalScore;
        }

        function getCurrentCategoryName() {
            const categoryNames = {
                physics: 'Fisika',
                chemistry: 'Kimia',
                biology: 'Biologi',
                earth: 'Ilmu Bumi'
            };
            return gameState.currentCategory ? categoryNames[gameState.currentCategory] : 'Pilih Kategori';
        }

        function updateProgress() {
            const totalCompleted = 
                gameState.completedLevels.physics.length +
                gameState.completedLevels.chemistry.length +
                gameState.completedLevels.biology.length +
                gameState.completedLevels.earth.length;
            
            const totalLevels = 400;
            const progress = (totalCompleted / totalLevels) * 100; 
            progressBar.style.width = `${progress}%`;
            progressBar.parentElement.title = `Progress Total (${totalCompleted}/${totalLevels} Level Selesai)`;
        }

        function saveProgress() {
            try {
                localStorage.setItem('scienceMasterProgress', JSON.stringify({
                    completedLevels: gameState.completedLevels,
                    totalScore: gameState.totalScore
                }));
            } catch (error) {
                console.error("Gagal menyimpan progress:", error);
            }
        }

        function loadProgress() {
            try {
                const savedProgress = localStorage.getItem('scienceMasterProgress');
                if (savedProgress) {
                    const progress = JSON.parse(savedProgress);
                    gameState.completedLevels = progress.completedLevels;
                    gameState.totalScore = progress.totalScore;
                }
            } catch (error) {
                console.error("Gagal memuat progress:", error);
            }
        }

        // Inisialisasi game
        loadProgress(); 
        updatePlayerInfo();
        updateProgress();
    </script>
</body>
</html>
