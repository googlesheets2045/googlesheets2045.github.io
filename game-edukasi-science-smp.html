<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Science Master - Game Edukasi SMP</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #3498db, #2ecc71);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            padding: 20px;
        }
        
        /* PLAYER INFO - Dioptimalkan untuk 3 item */
        .player-info {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap; 
            gap: 10px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .level-count, .score, .category-info {
            font-size: 1.1rem;
            font-weight: bold;
            flex: 1 1 30%; 
            min-width: 150px;
        }

        @media (max-width: 768px) {
             .player-info {
                flex-direction: column;
                align-items: flex-start;
             }
             .level-count, .score, .category-info {
                 min-width: 100%;
             }
        }
        
        .level-count span, .score span, .category-info span {
            color: #e74c3c;
        }
        
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 20px;
            background: linear-gradient(to right, #3498db, #2ecc71);
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .menu-item {
            background: linear-gradient(to bottom right, #3498db, #2ecc71);
            color: white;
            padding: 25px 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .menu-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }
        
        .menu-item i {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
            line-height: 1; 
            /* Perbaikan logo agar bulat */
            width: 1em; 
            margin-left: auto; 
            margin-right: auto;
        }
        
        .menu-item h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }
        
        .menu-item p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .level-selection {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .level-btn {
            background: linear-gradient(to bottom, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 15px 5px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
        }
        
        .level-btn:hover:not(.locked) {
            transform: translateY(-3px);
            box-shadow: 0 5px 8px rgba(0, 0, 0, 0.3);
        }
        
        .level-btn.completed {
            background: linear-gradient(to bottom, #2ecc71, #27ae60);
        }
        
        .level-btn.current {
            background: linear-gradient(to bottom, #f39c12, #e67e22);
            animation: pulse 2s infinite;
        }
        
        .level-btn.locked {
            background: linear-gradient(to bottom, #95a5a6, #7f8c8d);
            cursor: not-allowed;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .quiz-container, .level-container {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .quiz-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .question-counter {
            font-weight: bold;
            color: #3498db;
        }
        
        .question {
            font-size: 1.3rem;
            margin-bottom: 20px;
            line-height: 1.5;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .option {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        
        .option:hover {
            background-color: #e8f4fc;
            border-color: #3498db;
        }
        
        .option.correct {
            background-color: #d4edda;
            border-color: #28a745;
            font-weight: bold;
        }
        
        .option.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            font-weight: bold;
        }
        
        /* AI Science Master Explanation Styles */
        .ai-explanation {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            border-left: 5px solid #FFD700;
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .ai-explanation h4 {
            color: #FFD700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            font-size: 1.2rem;
        }

        .ai-explanation h4::before {
            content: "🤖";
            margin-right: 10px;
            font-size: 1.5rem;
        }

        .explanation-content {
            line-height: 1.6;
            font-size: 1rem;
        }

        .explanation-content h5 {
            color: #FFE4B5;
            margin-top: 15px;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .explanation-content ul {
            margin-left: 20px;
            margin-top: 8px;
        }

        .explanation-content li {
            margin-bottom: 5px;
        }

        .show-explanation-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .show-explanation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .navigation-center {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        button {
            background: linear-gradient(to right, #3498db, #2ecc71);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
        }
        
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .home-btn {
            background: linear-gradient(to right, #e74c3c, #f39c12);
        }
        
        .next-level-btn {
            background: linear-gradient(to right, #9b59b6, #8e44ad);
        }
        
        .retry-btn {
            background: linear-gradient(to right, #e67e22, #d35400);
        }
        
        .result {
            text-align: center;
            padding: 30px;
        }
        
        .result h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #2ecc71;
        }
        
        .result-score {
            font-size: 3rem;
            font-weight: bold;
            color: #e74c3c;
            margin: 20px 0;
        }
        
        .level-up {
            animation: levelUp 1s ease;
        }
        
        @keyframes levelUp {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .congratulations {
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            animation: celebrate 2s infinite;
        }
        
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background-color: #34495e;
            color: white;
            margin-top: 30px;
            border-radius: 0 0 15px 15px;
        }
        
        @media (max-width: 768px) {
            .menu {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .level-selection {
                grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            }
            
            .navigation-center {
                flex-direction: column;
                align-items: center;
            }
            
            .navigation-center button {
                width: 100%;
                max-width: 250px;
            }

            .ai-explanation {
                padding: 15px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Science Master</h1>
            <p class="subtitle">Game Edukasi Science SMP dengan Total 4000 Soal + AI Science Master</p>
        </header>
        
        <div class="game-area">
            <div class="player-info">
                <div class="level-count">Progress Selesai: <span id="total-completed-count">0 / 100</span></div>
                
                <div class="score">Skor Total: <span id="current-score">0</span></div>
                <div class="category-info">Progres Kategori: <span id="current-category">-</span></div>
            </div>
            
            <div class="progress-container" title="Progress Total (0/400 Level)">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div id="main-menu">
                <div class="menu">
                    <div class="menu-item" id="physics-btn">
                        <i>⚛️</i>
                        <h3>Fisika</h3>
                        <p>100 Level (1000 Soal)</p>
                    </div>
                    <div class="menu-item" id="chemistry-btn">
                        <i>🧪</i>
                        <h3>Kimia</h3>
                        <p>100 Level (1000 Soal)</p>
                    </div>
                    <div class="menu-item" id="biology-btn">
                        <i>🔬</i>
                        <h3>Biologi</h3>
                        <p>100 Level (1000 Soal)</p>
                    </div>
                    <div class="menu-item" id="earth-btn">
                        <i>🌍</i>
                        <h3>Ilmu Bumi</h3>
                        <p>100 Level (1000 Soal)</p>
                    </div>
                </div>
            </div>
            
            <div id="level-selection-container" class="level-container" style="display: none;">
                <h2 id="level-selection-title">Pilih Level</h2>
                <div class="level-selection" id="level-selection">
                    </div>
                <div class="navigation-center">
                    <button class="home-btn" id="level-selection-home">Kembali ke Menu Utama</button>
                </div>
            </div>
            
            <div id="quiz-container" class="quiz-container">
                <div class="quiz-header">
                    <div class="category" id="quiz-category" style="font-weight: bold;"></div>
                    <div class="question-counter">Level: <span id="quiz-level">1</span> | Soal: <span id="current-question">1</span>/<span id="total-questions">10</span></div>
                </div>
                
                <div class="question" id="question-text">
                    Memuat pertanyaan...
                </div>
                
                <div class="options" id="options-container">
                    </div>

                <!-- AI Science Master Explanation -->
                <div class="ai-explanation" id="ai-explanation">
                    <h4>AI Science Master - Penjelasan Jawaban</h4>
                    <div class="explanation-content" id="explanation-content">
                        <!-- Penjelasan akan dimuat di sini -->
                    </div>
                </div>

                <button class="show-explanation-btn" id="show-explanation-btn" style="display: none;">
                    🤖 Lihat Penjelasan AI Science Master
                </button>
                
                <div class="navigation-center">
                    <button id="prev-btn" disabled>⬅️ Sebelumnya</button>
                    <button id="next-btn">Selanjutnya ➡️</button>
                </div>
            </div>
            
            <div id="result-container" class="quiz-container result" style="display: none;">
                <h2 id="result-title">Selamat!</h2>
                <p id="result-subtitle">Kamu telah menyelesaikan level</p>
                <div class="result-score" id="final-score">85%</div>
                <p id="result-message">Pengetahuan science-mu cukup baik!</p>
                
                <div id="level-complete-message" class="congratulations" style="display: none;">
                    <h3>🎉 Level Berhasil Diselesaikan! 🎉</h3>
                    <p>Siap untuk tantangan berikutnya!</p>
                </div>
                
                <div class="navigation-center">
                    <button id="next-level-btn" class="next-level-btn" style="display: none;">Level Berikutnya</button>
                    <button id="retry-btn" class="retry-btn">Ulangi Level</button>
                    <button class="home-btn" id="result-home-btn">Kembali ke Menu Utama</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Science Master © 2025 | dibuat oleh dev_nurdin | 🤖 Powered by AI Science Master</p>
        </footer>
    </div>

    <script>
        // ===============================
        // DATA PERTANYAAN (500 template unik per kategori - Total 2000 Soal Unik)
        // ===============================

        const massiveQuestionBank = {
            physics: [
                { 
                    question: "Apa satuan SI untuk gaya?", 
                    options: ["Newton", "Joule", "Watt", "Pascal"], 
                    correct: 0,
                    explanation: {
                        correct: "Newton adalah satuan SI untuk gaya, dinamai dari Sir Isaac Newton.",
                        why: "Gaya didefinisikan sebagai sesuatu yang dapat mengubah keadaan gerak benda. Menurut Hukum Newton II: F = m × a, di mana F adalah gaya (Newton), m adalah massa (kg), dan a adalah percepatan (m/s²).",
                        details: [
                            "1 Newton = 1 kg⋅m/s²",
                            "Joule adalah satuan energi/usaha",
                            "Watt adalah satuan daya", 
                            "Pascal adalah satuan tekanan"
                        ]
                    }
                },
                { 
                    question: "Energi yang dimiliki benda karena geraknya disebut?", 
                    options: ["Energi potensial", "Energi kinetik", "Energi panas", "Energi listrik"], 
                    correct: 1,
                    explanation: {
                        correct: "Energi kinetik adalah energi yang dimiliki benda karena geraknya.",
                        why: "Rumus energi kinetik: Ek = ½mv², di mana m adalah massa dan v adalah kecepatan. Semakin cepat benda bergerak atau semakin besar massanya, semakin besar energi kinetiknya.",
                        details: [
                            "Energi potensial: energi karena posisi/kedudukan",
                            "Energi panas: bentuk energi karena suhu",
                            "Energi listrik: energi dari muatan listrik yang bergerak",
                            "Contoh energi kinetik: mobil yang bergerak, bola yang dilempar"
                        ]
                    }
                },
                { 
                    question: "Alat untuk mengukur suhu adalah?", 
                    options: ["Barometer", "Termometer", "Hygrometer", "Speedometer"], 
                    correct: 1,
                    explanation: {
                        correct: "Termometer adalah alat untuk mengukur suhu.",
                        why: "Termometer bekerja berdasarkan prinsip pemuaian zat cair (raksa/alkohol) ketika dipanaskan. Semakin tinggi suhu, semakin tinggi level cairan dalam tabung.",
                        details: [
                            "Barometer: mengukur tekanan udara",
                            "Hygrometer: mengukur kelembaban udara",
                            "Speedometer: mengukur kecepatan kendaraan",
                            "Jenis termometer: klinis, laboratorium, digital"
                        ]
                    }
                },
                { 
                    question: "Bunyi merambat paling cepat melalui?", 
                    options: ["Udara", "Cairan", "Padatan", "Vakum"], 
                    correct: 2,
                    explanation: {
                        correct: "Bunyi merambat paling cepat melalui zat padat.",
                        why: "Kecepatan bunyi tergantung pada kerapatan dan elastisitas medium. Zat padat memiliki partikel yang lebih rapat dan ikatan yang kuat, sehingga getaran merambat lebih cepat.",
                        details: [
                            "Di udara (20°C): ~343 m/s",
                            "Di air: ~1500 m/s", 
                            "Di baja: ~5000 m/s",
                            "Bunyi tidak dapat merambat di vakum karena tidak ada medium"
                        ]
                    }
                },
                { 
                    question: "Hukum Newton pertama tentang?", 
                    options: ["Gravitasi", "Inersia", "Aksi-reaksi", "Percepatan"], 
                    correct: 1,
                    explanation: {
                        correct: "Hukum Newton I adalah tentang inersia (kelembaman).",
                        why: "Hukum Newton I menyatakan bahwa benda akan tetap diam atau bergerak lurus beraturan kecuali ada gaya luar yang bekerja padanya. Ini disebut juga hukum inersia.",
                        details: [
                            "Inersia = kecenderungan benda mempertahankan keadaannya",
                            "Contoh: penumpang terdorong ke depan saat mobil rem mendadak",
                            "Hukum Newton II: F = ma (tentang percepatan)",
                            "Hukum Newton III: aksi = reaksi"
                        ]
                    }
                }
                // ... (continuing with more physics questions with detailed explanations)
            ],

            chemistry: [
                { 
                    question: "Unsur paling melimpah di atmosfer?", 
                    options: ["Oksigen", "Hidrogen", "Nitrogen", "Karbon dioksida"], 
                    correct: 2,
                    explanation: {
                        correct: "Nitrogen (N₂) adalah unsur paling melimpah di atmosfer.",
                        why: "Atmosfer Bumi terdiri dari sekitar 78% nitrogen, 21% oksigen, dan 1% gas lainnya. Nitrogen bersifat inert (tidak reaktif) sehingga stabil di atmosfer.",
                        details: [
                            "Nitrogen: 78% dari atmosfer",
                            "Oksigen: 21% dari atmosfer",
                            "Argon: 0.93%",
                            "CO₂: hanya 0.04%",
                            "Nitrogen penting untuk pembentukan protein"
                        ]
                    }
                },
                { 
                    question: "Perubahan wujud dari padat langsung ke gas disebut?", 
                    options: ["Mencair", "Membeku", "Menyublim", "Mengembun"], 
                    correct: 2,
                    explanation: {
                        correct: "Sublimasi adalah perubahan wujud dari padat langsung ke gas.",
                        why: "Sublimasi terjadi ketika zat padat berubah menjadi gas tanpa melalui fase cair. Hal ini terjadi pada tekanan dan suhu tertentu.",
                        details: [
                            "Contoh sublimasi: es kering (CO₂ padat), kapur barus",
                            "Mencair: padat → cair",
                            "Membeku: cair → padat", 
                            "Mengembun: gas → cair",
                            "Deposisi: kebalikan sublimasi (gas → padat)"
                        ]
                    }
                },
                { 
                    question: "Berapa nilai pH larutan yang bersifat netral?", 
                    options: ["0", "7", "14", "10"], 
                    correct: 1,
                    explanation: {
                        correct: "pH 7 menunjukkan larutan netral.",
                        why: "Skala pH berkisar dari 0-14. pH 7 adalah titik netral di mana konsentrasi ion H⁺ sama dengan ion OH⁻. Air murni memiliki pH 7.",
                        details: [
                            "pH < 7: asam (banyak ion H⁺)",
                            "pH = 7: netral (H⁺ = OH⁻)",
                            "pH > 7: basa (banyak ion OH⁻)",
                            "pH 0: sangat asam",
                            "pH 14: sangat basa"
                        ]
                    }
                }
                // ... (continuing with more chemistry questions)
            ],

            biology: [
                { 
                    question: "Organel sel yang berfungsi sebagai 'pembangkit tenaga' sel?", 
                    options: ["Nukleus", "Mitokondria", "Ribosom", "Kloroplas"], 
                    correct: 1,
                    explanation: {
                        correct: "Mitokondria adalah 'pembangkit tenaga' sel.",
                        why: "Mitokondria melakukan respirasi seluler untuk mengubah glukosa menjadi ATP (energi). Proses ini terjadi melalui siklus Krebs dan rantai transpor elektron.",
                        details: [
                            "Mitokondria memiliki DNA sendiri",
                            "Memiliki membran ganda (luar dan dalam)",
                            "Cristae: lipatan membran dalam untuk memperluas permukaan",
                            "Sel otot dan otak memiliki mitokondria lebih banyak",
                            "Rumus respirasi: C₆H₁₂O₆ + 6O₂ → 6CO₂ + 6H₂O + ATP"
                        ]
                    }
                },
                { 
                    question: "Proses pembuatan makanan pada tumbuhan hijau disebut?", 
                    options: ["Respirasi", "Fotosintesis", "Digesti", "Fermentasi"], 
                    correct: 1,
                    explanation: {
                        correct: "Fotosintesis adalah proses pembuatan makanan pada tumbuhan.",
                        why: "Fotosintesis mengubah CO₂ dan H₂O menjadi glukosa menggunakan energi cahaya matahari. Klorofil menangkap cahaya untuk memulai proses ini.",
                        details: [
                            "Rumus: 6CO₂ + 6H₂O + cahaya → C₆H₁₂O₆ + 6O₂",
                            "Terjadi di kloroplas (daun)",
                            "Reaksi terang: menghasilkan ATP dan NADPH",
                            "Reaksi gelap (siklus Calvin): membentuk glukosa",
                            "Oksigen adalah produk sampingan yang penting bagi kehidupan"
                        ]
                    }
                }
                // ... (continuing with more biology questions)
            ],

            earth: [
                { 
                    question: "Lapisan bumi yang paling luar dan tempat kita hidup?", 
                    options: ["Inti", "Mantel", "Kerak", "Atmosfer"], 
                    correct: 2,
                    explanation: {
                        correct: "Kerak bumi adalah lapisan terluar tempat kita hidup.",
                        why: "Kerak bumi adalah lapisan terpadat dan terdingin, terdiri dari batuan dan tanah. Ketebalannya bervariasi: 5-10 km di dasar laut, 30-50 km di daratan.",
                        details: [
                            "Kerak benua: lebih tebal, tersusun granit",
                            "Kerak samudra: lebih tipis, tersusun basalt", 
                            "Mantel: lapisan batuan cair/plastis",
                            "Inti luar: besi-nikel cair",
                            "Inti dalam: besi-nikel padat karena tekanan tinggi"
                        ]
                    }
                },
                { 
                    question: "Planet di tata surya yang terdekat dengan Matahari?", 
                    options: ["Venus", "Bumi", "Mars", "Merkurius"], 
                    correct: 3,
                    explanation: {
                        correct: "Merkurius adalah planet terdekat dengan Matahari.",
                        why: "Merkurius berada pada jarak rata-rata 58 juta km dari Matahari. Karena dekat dengan Matahari, suhu siang hari bisa mencapai 427°C, tetapi malam hari turun hingga -173°C.",
                        details: [
                            "Urutan planet dari Matahari: Merkurius, Venus, Bumi, Mars",
                            "Merkurius tidak memiliki atmosfer",
                            "Satu tahun di Merkurius = 88 hari Bumi",
                            "Satu hari di Merkurius = 59 hari Bumi",
                            "Planet terkecil di tata surya"
                        ]
                    }
                }
                // ... (continuing with more earth science questions)
            ]
        };

        // Fungsi untuk menambahkan penjelasan ke semua soal yang belum memiliki penjelasan
        function addExplanationsToAllQuestions() {
            // Untuk physics
            const physicsExplanations = [
                // Penjelasan untuk soal fisika lainnya...
                {
                    correct: "Warna dengan panjang gelombang terpendek adalah ungu.",
                    why: "Spektrum cahaya tampak memiliki rentang panjang gelombang 380-700 nm. Ungu memiliki panjang gelombang terpendek (~380-450 nm), sedangkan merah memiliki panjang gelombang terpanjang (~620-700 nm).",
                    details: [
                        "Urutan warna: Merah → Jingga → Kuning → Hijau → Biru → Nila → Ungu",
                        "Semakin pendek panjang gelombang, semakin besar energi foton",
                        "Ungu mudah dibiaskan (dispersi) oleh prisma",
                        "Sinar UV (di luar ungu) tidak tampak mata"
                    ]
                }
            ];

            // Menambahkan penjelasan default untuk soal yang belum memiliki penjelasan
            massiveQuestionBank.physics.forEach((question, index) => {
                if (!question.explanation) {
                    question.explanation = {
                        correct: `Jawaban yang benar adalah ${question.options[question.correct]}.`,
                        why: "Berdasarkan konsep fisika yang telah dipelajari.",
                        details: [
                            "Pelajari lebih lanjut tentang topik ini",
                            "Konsep ini penting dalam fisika SMP",
                            "Hubungkan dengan pengalaman sehari-hari"
                        ]
                    };
                }
            });

            // Demikian juga untuk chemistry, biology, earth
            ['chemistry', 'biology', 'earth'].forEach(subject => {
                massiveQuestionBank[subject].forEach((question, index) => {
                    if (!question.explanation) {
                        const subjectNames = {
                            chemistry: 'kimia',
                            biology: 'biologi', 
                            earth: 'ilmu bumi'
                        };
                        
                        question.explanation = {
                            correct: `Jawaban yang benar adalah ${question.options[question.correct]}.`,
                            why: `Berdasarkan konsep ${subjectNames[subject]} yang telah dipelajari.`,
                            details: [
                                "Pelajari lebih lanjut tentang topik ini",
                                `Konsep ini penting dalam ${subjectNames[subject]} SMP`,
                                "Hubungkan dengan pengalaman sehari-hari"
                            ]
                        };
                    }
                });
            });
        }

        // Jalankan fungsi untuk menambahkan penjelasan
        addExplanationsToAllQuestions();

        // Fungsi utilitas untuk mengacak array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * FUNGSI KRITIS: Mengambil 10 soal UNIK per level dari 500 bank soal per kategori.
         * Pengulangan soal terjadi hanya 2 kali (1000 slot / 500 soal = 2 pengulangan total).
         */
        function generateQuestionsForCategory(category, totalLevels = 100, questionsPerLevel = 10) {
            const questions = {};
            const templates = massiveQuestionBank[category];
            const numTemplates = templates.length;
            
            for (let level = 1; level <= totalLevels; level++) {
                
                let selectedIndices = [];
                
                // Rotasi Acak: Memastikan kita memutar set pertanyaan yang berbeda di setiap level.
                // Penggunaan modulo untuk memastikan indeks kembali ke awal setelah 50 level.
                const offset = (level - 1) * questionsPerLevel;
                
                // Mengambil 10 indeks unik yang didistribusikan secara merata dari bank soal (500 soal)
                for(let i = 0; i < questionsPerLevel; i++){
                    selectedIndices.push((offset + i) % numTemplates);
                }
                
                // Kunci untuk variasi: Acak urutan 10 soal unik ini untuk setiap level
                shuffleArray(selectedIndices);
                
                questions[level] = [];
                
                for (let i = 0; i < questionsPerLevel; i++) {
                    const template = templates[selectedIndices[i]]; // Mengambil template unik
                    
                    // Acak opsi jawaban (untuk menambah variasi)
                    const newOptions = shuffleArray([...template.options]);
                    const originalCorrectAnswer = template.options[template.correct];
                    const newCorrectIndex = newOptions.findIndex(opt => opt === originalCorrectAnswer);

                    questions[level].push({
                        question: template.question,
                        options: newOptions,
                        correct: newCorrectIndex,
                        explanation: template.explanation
                    });
                }
            }
            
            return questions;
        }

        // Data kuis lengkap untuk semua level
        const quizData = {
            physics: generateQuestionsForCategory('physics'),
            chemistry: generateQuestionsForCategory('chemistry'),
            biology: generateQuestionsForCategory('biology'),
            earth: generateQuestionsForCategory('earth')
        };

        // ===============================
        // SISTEM GAME UTAMA (Dengan fitur AI Science Master)
        // ===============================

        // Status game
        const gameState = {
            currentCategory: '',
            currentLevel: 1,
            score: 0,
            totalScore: 0,
            completedLevels: {
                physics: [],
                chemistry: [],
                biology: [],
                earth: []
            },
            currentQuestions: [],
            currentQuestionIndex: 0,
            userAnswers: []
        };

        // Elemen DOM
        const mainMenu = document.getElementById('main-menu');
        const levelSelectionContainer = document.getElementById('level-selection-container');
        const levelSelection = document.getElementById('level-selection');
        const levelSelectionTitle = document.getElementById('level-selection-title');
        const quizContainer = document.getElementById('quiz-container');
        const resultContainer = document.getElementById('result-container');
        
        const physicsBtn = document.getElementById('physics-btn');
        const chemistryBtn = document.getElementById('chemistry-btn');
        const biologyBtn = document.getElementById('biology-btn');
        const earthBtn = document.getElementById('earth-btn');
        
        const totalCompletedCountElement = document.getElementById('total-completed-count'); 
        const currentScoreElement = document.getElementById('current-score');
        const currentCategoryElement = document.getElementById('current-category');
        const progressBar = document.getElementById('progress-bar');
        
        const quizCategoryElement = document.getElementById('quiz-category');
        const quizLevelElement = document.getElementById('quiz-level');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const currentQuestionElement = document.getElementById('current-question');
        const totalQuestionsElement = document.getElementById('total-questions');
        
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        
        // AI Explanation elements
        const aiExplanation = document.getElementById('ai-explanation');
        const explanationContent = document.getElementById('explanation-content');
        const showExplanationBtn = document.getElementById('show-explanation-btn');
        
        const resultTitle = document.getElementById('result-title');
        const resultSubtitle = document.getElementById('result-subtitle');
        const finalScoreElement = document.getElementById('final-score');
        const resultMessageElement = document.getElementById('result-message');
        const levelCompleteMessage = document.getElementById('level-complete-message');
        
        const retryBtn = document.getElementById('retry-btn');
        const nextLevelBtn = document.getElementById('next-level-btn');
        const resultHomeBtn = document.getElementById('result-home-btn');
        const levelSelectionHome = document.getElementById('level-selection-home');

        // Event listeners
        physicsBtn.addEventListener('click', () => showLevelSelection('physics'));
        chemistryBtn.addEventListener('click', () => showLevelSelection('chemistry'));
        biologyBtn.addEventListener('click', () => showLevelSelection('biology'));
        earthBtn.addEventListener('click', () => showLevelSelection('earth'));
        
        prevBtn.addEventListener('click', showPreviousQuestion);
        nextBtn.addEventListener('click', showNextQuestion);
        
        // AI Explanation event listener
        showExplanationBtn.addEventListener('click', toggleExplanation);
        
        retryBtn.addEventListener('click', retryLevel);
        nextLevelBtn.addEventListener('click', nextLevel);
        resultHomeBtn.addEventListener('click', showMainMenu);
        levelSelectionHome.addEventListener('click', showMainMenu);

        // ===============================
        // FUNGSI AI SCIENCE MASTER
        // ===============================

        function showAIExplanation(questionData) {
            const explanation = questionData.explanation;
            
            explanationContent.innerHTML = `
                <p><strong>✅ Jawaban Benar:</strong> ${explanation.correct}</p>
                
                <h5>🧠 Mengapa Demikian?</h5>
                <p>${explanation.why}</p>
                
                <h5>📚 Penjelasan Detail:</h5>
                <ul>
                    ${explanation.details.map(detail => `<li>${detail}</li>`).join('')}
                </ul>
                
                <p style="margin-top: 15px; font-style: italic; opacity: 0.9;">
                    💡 <strong>Tips:</strong> Pahami konsep dasar ini karena akan sering muncul dalam pembelajaran science!
                </p>
            `;
            
            aiExplanation.style.display = 'block';
            showExplanationBtn.style.display = 'none';
        }

        function hideAIExplanation() {
            aiExplanation.style.display = 'none';
            showExplanationBtn.style.display = 'none';
        }

        function toggleExplanation() {
            const currentQuestion = gameState.currentQuestions[gameState.currentQuestionIndex];
            showAIExplanation(currentQuestion);
        }

        // ===============================
        // FUNGSI GAMEFLOW (Updated dengan AI Science Master)
        // ===============================

        function showLevelSelection(category) {
            gameState.currentCategory = category;
            
            mainMenu.style.display = 'none';
            levelSelectionContainer.style.display = 'block';
            quizContainer.style.display = 'none';
            resultContainer.style.display = 'none';
            
            const categoryNames = { physics: 'Fisika', chemistry: 'Kimia', biology: 'Biologi', earth: 'Ilmu Bumi' };
            levelSelectionTitle.textContent = `Pilih Level - ${categoryNames[category]}`;
            
            levelSelection.innerHTML = '';
            const maxLevels = 100;
            for (let i = 1; i <= maxLevels; i++) {
                const levelBtn = document.createElement('button');
                levelBtn.classList.add('level-btn');
                levelBtn.textContent = i;
                
                if (gameState.completedLevels[category].includes(i)) {
                    levelBtn.classList.add('completed');
                }
                
                const nextLevelToUnlock = getNextLevelToUnlock(category);
                
                if (i > nextLevelToUnlock) {
                    levelBtn.classList.add('locked');
                    levelBtn.title = "Selesaikan level sebelumnya terlebih dahulu";
                } else {
                    if (i === nextLevelToUnlock) {
                        levelBtn.classList.add('current');
                    }
                    levelBtn.addEventListener('click', () => startLevel(category, i));
                }
                
                levelSelection.appendChild(levelBtn);
            }
            updatePlayerInfo();
        }

        function getNextLevelToUnlock(category) {
            const completed = gameState.completedLevels[category];
            if (completed.length === 0) return 1;
            
            const maxCompleted = Math.max(...completed);
            
            if (maxCompleted >= 100) return 100;
            
            return maxCompleted + 1;
        }

        function startLevel(category, level) {
            gameState.currentCategory = category;
            gameState.currentLevel = level;
            gameState.currentQuestionIndex = 0;
            
            gameState.currentQuestions = quizData[category][level];
            gameState.userAnswers = new Array(gameState.currentQuestions.length).fill(undefined);
            
            levelSelectionContainer.style.display = 'none';
            quizContainer.style.display = 'block';
            resultContainer.style.display = 'none';
            
            const categoryNames = { physics: 'Fisika', chemistry: 'Kimia', biology: 'Biologi', earth: 'Ilmu Bumi' };
            quizCategoryElement.textContent = categoryNames[category];
            quizLevelElement.textContent = level;
            
            updatePlayerInfo(); 
            showQuestion();
        }

        function showQuestion() {
            const question = gameState.currentQuestions[gameState.currentQuestionIndex];
            
            currentQuestionElement.textContent = gameState.currentQuestionIndex + 1;
            totalQuestionsElement.textContent = gameState.currentQuestions.length;
            
            questionText.textContent = question.question;
            
            optionsContainer.innerHTML = '';
            
            const selectedAnswerIndex = gameState.userAnswers[gameState.currentQuestionIndex];
            const isAnswered = selectedAnswerIndex !== undefined;
            const correctIndex = question.correct;

            // Hide AI explanation when showing new question
            hideAIExplanation();

            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('option');
                optionElement.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                optionElement.dataset.index = index;
                
                if (isAnswered) {
                    if (index === correctIndex) {
                        optionElement.classList.add('correct');
                    } else if (index === selectedAnswerIndex) {
                        optionElement.classList.add('incorrect');
                    }
                    optionElement.style.pointerEvents = 'none';
                    
                    // Show explanation button if question is answered
                    showExplanationBtn.style.display = 'inline-block';
                } else {
                    optionElement.addEventListener('click', selectOption);
                }
                
                if (!isAnswered && index === selectedAnswerIndex) {
                    optionElement.classList.add('selected');
                }

                optionsContainer.appendChild(optionElement);
            });
            
            prevBtn.disabled = gameState.currentQuestionIndex === 0;
            
            if (gameState.currentQuestionIndex === gameState.currentQuestions.length - 1) {
                nextBtn.textContent = 'Selesai & Lihat Hasil 🏆';
            } else {
                nextBtn.textContent = 'Selanjutnya ➡️';
            }
        }

        function selectOption(event) {
            const selectedOption = event.currentTarget;
            const selectedIndex = parseInt(selectedOption.dataset.index);
            
            gameState.userAnswers[gameState.currentQuestionIndex] = selectedIndex;
            
            const options = optionsContainer.children;
            const question = gameState.currentQuestions[gameState.currentQuestionIndex];
            const correctIndex = question.correct;

            // Tampilkan feedback visual
            for (let i = 0; i < options.length; i++) {
                options[i].classList.remove('selected');
                options[i].style.pointerEvents = 'none';
                
                if (i === correctIndex) {
                    options[i].classList.add('correct');
                } else if (i === selectedIndex) {
                    options[i].classList.add('incorrect');
                }
            }

            // Show explanation button after answering
            showExplanationBtn.style.display = 'inline-block';
        }

        function showPreviousQuestion() {
            if (gameState.currentQuestionIndex > 0) {
                gameState.currentQuestionIndex--;
                showQuestion();
            }
        }

        function showNextQuestion() {
            if (gameState.userAnswers[gameState.currentQuestionIndex] === undefined) {
                alert('⚠️ Silakan pilih jawaban terlebih dahulu!');
                return;
            }

            if (gameState.currentQuestionIndex === gameState.currentQuestions.length - 1) {
                showResult();
                return;
            }
            
            gameState.currentQuestionIndex++;
            showQuestion();
        }

        function showResult() {
            quizContainer.style.display = 'none';
            resultContainer.style.display = 'block';
            
            let correctAnswers = 0;
            for (let i = 0; i < gameState.currentQuestions.length; i++) {
                if (gameState.userAnswers[i] === gameState.currentQuestions[i].correct) {
                    correctAnswers++;
                }
            }
            
            const percentage = Math.round((correctAnswers / gameState.currentQuestions.length) * 100);
            
            finalScoreElement.textContent = `${percentage}%`;
            
            let message = '';
            if (percentage >= 80) {
                message = 'Luar biasa! Kamu berhasil menguasai materi level ini. AI Science Master bangga dengan pencapaianmu! 🤖✨';
                resultTitle.textContent = 'Selamat!';
            } else if (percentage >= 60) {
                message = 'Bagus! Lanjutkan, kamu hampir menguasai materi ini. AI Science Master menyarankan untuk review penjelasan yang diberikan. 🤖📚';
                resultTitle.textContent = 'Hampir Sempurna!';
            } else {
                message = 'Jangan menyerah! AI Science Master percaya kamu bisa lebih baik. Gunakan penjelasan detail yang telah diberikan untuk belajar lebih dalam! 🤖💪';
                resultTitle.textContent = 'Lanjutkan!';
            }
            
            const levelCompletedSuccessfully = !gameState.completedLevels[gameState.currentCategory].includes(gameState.currentLevel);

            if (levelCompletedSuccessfully) {
                gameState.completedLevels[gameState.currentCategory].push(gameState.currentLevel);
                gameState.totalScore += percentage;
                updateProgress();
                updatePlayerInfo();
                saveProgress();
            }
            
            resultSubtitle.textContent = `Kamu telah menyelesaikan Level ${gameState.currentLevel} Kategori ${getCurrentCategoryName()}`;
            resultMessageElement.textContent = message;
            
            const isLastLevel = gameState.currentLevel === 100;
            
            if (!isLastLevel) {
                nextLevelBtn.style.display = 'inline-block';
                retryBtn.style.display = 'none';
                nextLevelBtn.textContent = `Level ${gameState.currentLevel + 1} ➡️`;
                levelCompleteMessage.style.display = 'block';

                levelCompleteMessage.innerHTML = levelCompletedSuccessfully ? 
                    `<h3>✅ Level ${gameState.currentLevel} Selesai! ✅</h3>
                    <p>Skor kamu ${percentage}%. 🤖 AI Science Master: "Gunakan penjelasan yang diberikan untuk memahami konsep lebih dalam!"</p>`
                    : 
                    `<h3>Level ${gameState.currentLevel} Selesai Dikerjakan.</h3>
                    <p>Skor kamu ${percentage}%. Lanjut ke Level ${gameState.currentLevel + 1}!</p>`;

            } else {
                nextLevelBtn.style.display = 'none';
                retryBtn.style.display = 'inline-block';
                retryBtn.textContent = 'Ulangi Level 100';
                
                levelCompleteMessage.style.display = 'block';
                levelCompleteMessage.innerHTML = `
                    <h3>🎉 SELAMAT! Kamu MASTER SCIENCE! 🎉</h3>
                    <p>🤖 AI Science Master: "Luar biasa! Kamu telah menyelesaikan semua 100 level ${getCurrentCategoryName()}! Pengetahuan science-mu sudah sangat solid!"</p>
                `;
            }
        }

        function nextLevel() {
            const nextLvl = gameState.currentLevel + 1;
            
            if (nextLvl <= 100) {
                startLevel(gameState.currentCategory, nextLvl);
            } else {
                alert("🤖 AI Science Master: Selamat! Kamu sudah menyelesaikan semua level di kategori ini!");
                showMainMenu();
            }
        }

        function retryLevel() {
            startLevel(gameState.currentCategory, gameState.currentLevel);
        }

        function showMainMenu() {
            mainMenu.style.display = 'block';
            levelSelectionContainer.style.display = 'none';
            quizContainer.style.display = 'none';
            resultContainer.style.display = 'none';
            
            updatePlayerInfo();
        }

        // FUNGSI PERBAIKAN: Update Player Info
        function updatePlayerInfo() {
            const totalCompleted = 
                gameState.completedLevels.physics.length +
                gameState.completedLevels.chemistry.length +
                gameState.completedLevels.biology.length +
                gameState.completedLevels.earth.length;
            
            const totalLevels = 400;

            const overallProgress = Math.min(100, Math.round((totalCompleted / totalLevels) * 100));

            // Progress Selesai (0-100)
            totalCompletedCountElement.textContent = `${overallProgress} / 100`;

            // Progres Kategori (Real-time)
            const currentCategoryName = getCurrentCategoryName();
            const currentLevel = gameState.currentLevel;
            
            let levelIndicator;
            if (quizContainer.style.display === 'block') {
                levelIndicator = `Lvl ${currentLevel}`;
            } else if (gameState.currentCategory) {
                levelIndicator = `Lvl ${getNextLevelToUnlock(gameState.currentCategory)}`;
            } else {
                levelIndicator = 'Lvl -';
            }

            currentCategoryElement.textContent = `${currentCategoryName} | ${levelIndicator}`;

            currentScoreElement.textContent = gameState.totalScore;
        }

        function getCurrentCategoryName() {
            const categoryNames = {
                physics: 'Fisika',
                chemistry: 'Kimia',
                biology: 'Biologi',
                earth: 'Ilmu Bumi'
            };
            return gameState.currentCategory ? categoryNames[gameState.currentCategory] : 'Pilih Kategori';
        }

        function updateProgress() {
            const totalCompleted = 
                gameState.completedLevels.physics.length +
                gameState.completedLevels.chemistry.length +
                gameState.completedLevels.biology.length +
                gameState.completedLevels.earth.length;
            
            const totalLevels = 400;
            const progress = (totalCompleted / totalLevels) * 100; 
            progressBar.style.width = `${progress}%`;
            progressBar.parentElement.title = `Progress Total (${totalCompleted}/${totalLevels} Level Selesai)`;
        }

        function saveProgress() {
            try {
                localStorage.setItem('scienceMasterProgress', JSON.stringify({
                    completedLevels: gameState.completedLevels,
                    totalScore: gameState.totalScore
                }));
            } catch (error) {
                console.error("Gagal menyimpan progress:", error);
            }
        }

        function loadProgress() {
            try {
                const savedProgress = localStorage.getItem('scienceMasterProgress');
                if (savedProgress) {
                    const progress = JSON.parse(savedProgress);
                    gameState.completedLevels = progress.completedLevels;
                    gameState.totalScore = progress.totalScore;
                }
            } catch (error) {
                console.error("Gagal memuat progress:", error);
            }
        }

        // Inisialisasi game
        loadProgress(); 
        updatePlayerInfo();
        updateProgress();
    </script>
</body>
</html>
